---
title: "Means and effects"
date: "2023-03-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(DeclareDesign)
library(Rinteract)
library(tidyverse)
library(ggh4x)

```


```{r}
df <- fabricate(2000,
                X1 = complete_ra(N),
                X2 = complete_ra(N),
                X3 = complete_ra(N),
                X4 = complete_ra(N),
                Y = X1 + X3 - 2*X1*X2 + X1*X2*X3*X4 + rnorm(N))

```

Test function

2-way interaction

```{r}
#| fig.height: 3
#| fig.width: 7

model <- lm(Y ~ X1 * X2, data = df)

data <-
  int_conditions(model, df)

int_graph(data, facet = X1~X2) +
  ggtitle("test")


```


3-way interaction

```{r}
#| fig.height: 7
#| fig.width: 14

model <- lm(Y ~ X1 * X2 * X3, data = df)

data <-
  int_conditions(model, df)

int_graph(data, facet = X1~X2+X3) +
  ggtitle("3way interaction")


```


4-way interaction

```{r}
#| fig.height: 14
#| fig.width: 14

model <- lm(Y ~ X1 * X2 * X3 * X4, data = df)

data <-
  int_conditions(model, df)

int_graph(data, facet = X1+X2~X3+X4) +
  ggtitle("4way interaction")


```
